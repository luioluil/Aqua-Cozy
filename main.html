<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aqua-Intelligence | Ultimate Dashboard</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap-grid.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Outfit"', 'sans-serif'],
                        mono: ['"Space Grotesk"', 'monospace'],
                    },
                    colors: {
                        deep: '#030712',
                        glass: 'rgba(255, 255, 255, 0.03)',
                        glassBorder: 'rgba(255, 255, 255, 0.08)',
                        primary: '#6366f1',
                        accent: '#06b6d4',
                        success: '#10b981',
                        danger: '#f43f5e',
                    },
                    boxShadow: {
                        'neon': '0 0 20px rgba(6, 182, 212, 0.3)',
                        'glass': '0 8px 32px 0 rgba(0, 0, 0, 0.5)',
                    },
                    animation: {
                        'blob': 'blob 7s infinite',
                        'scan': 'scan 4s linear infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        scan: {
                            '0%': { top: '-100%' },
                            '100%': { top: '100%' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #030712; color: #e2e8f0; overflow-x: hidden; }
        .ambient-bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; overflow: hidden; background: radial-gradient(circle at 50% 50%, #111827 0%, #030712 100%); }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; animation: blob 10s infinite alternate; }
        .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #4f46e5; animation-delay: 0s; }
        .orb-2 { bottom: -10%; right: -10%; width: 50vw; height: 50vw; background: #06b6d4; animation-delay: 2s; }
        .glass-panel { background: linear-gradient(145deg, rgba(30, 41, 59, 0.4), rgba(15, 23, 42, 0.6)); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 1.5rem; transition: all 0.4s; }
        .glass-panel:hover { border-color: rgba(255, 255, 255, 0.2); transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0,0,0,0.4); }
        .progress-ring__circle { transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1); transform: rotate(-90deg); transform-origin: 50% 50%; }
        .modern-input { background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); color: white; transition: all 0.3s ease; }
        .modern-input:focus { outline: none; border-color: #06b6d4; background: rgba(0, 0, 0, 0.5); }
        .scan-line { width: 100%; height: 2px; background: rgba(6, 182, 212, 0.5); box-shadow: 0 0 10px rgba(6, 182, 212, 0.8); position: absolute; left: 0; animation: scan 3s linear infinite; }
        .status-dot-live { width: 8px; height: 8px; background-color: #ef4444; border-radius: 50%; animation: pulse-red 2s infinite; }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
        
        /* Toggle Switch Updated */
        .toggle-checkbox:checked { right: 0; border-color: #10b981; }
        .toggle-checkbox:checked + .toggle-label { background-color: #10b981; }
        .toggle-label { background-color: #374151; }
        
    </style>
</head>
<body class="selection:bg-accent selection:text-white">

    <div class="ambient-bg">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>

    <div class="container-xxl py-5">
        <header class="flex flex-col md:flex-row justify-between items-center mb-5 animate__animated animate__fadeInDown">
            <div class="flex items-center gap-4 mb-4 md:mb-0">
                <div class="relative w-14 h-14">
                    <div class="absolute inset-0 bg-accent rounded-2xl blur opacity-40"></div>
                    <div class="relative w-full h-full rounded-2xl bg-gradient-to-br from-indigo-500 to-cyan-500 flex items-center justify-center border border-white/20">
                        <i class="fa-solid fa-water text-white text-2xl"></i>
                    </div>
                </div>
                <div>
                    <h1 class="text-3xl font-bold text-white tracking-tight leading-none font-sans">Aqua-Intelligence</h1>
                    <p class="text-sm text-cyan-400 font-mono tracking-widest uppercase opacity-80 mt-1">System V3.5 (Enhanced)</p>
                </div>
            </div>
            
            <div class="glass-panel px-4 py-2 flex items-center gap-3 rounded-full">
                <div class="flex flex-col items-end mr-1">
                    <span class="text-[10px] text-slate-400 uppercase tracking-wider font-bold">Connection</span>
                    <span class="text-xs font-bold text-emerald-400 font-mono" id="statusText">INITIALIZING...</span>
                </div>
                <div class="relative">
                    <div class="w-3 h-3 bg-slate-500 rounded-full" id="statusDot"></div>
                    <div class="absolute inset-0 bg-emerald-500 rounded-full animate-ping opacity-0" id="statusPing"></div>
                </div>
            </div>
        </header>

        <div class="row g-4">
            <div class="col-lg-8 animate__animated animate__fadeInLeft">
                <div class="d-flex flex-column gap-4">
                    <div class="glass-panel p-2 relative h-[450px] overflow-hidden group">
                        <div class="absolute top-5 left-5 z-20 flex items-center gap-2 bg-black/50 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/10">
                            <div class="status-dot-live"></div>
                            <span class="text-[10px] font-bold text-white tracking-wider">LIVE FEED</span>
                        </div>
                        <div class="absolute top-5 right-5 z-20 text-[10px] font-mono text-white/50 bg-black/50 px-2 py-1 rounded">
                            ESP32-CAM-01
                        </div>
                        <div class="scan-line z-10 opacity-30 pointer-events-none"></div>
                        <div class="w-full h-full rounded-xl bg-slate-900 flex flex-col items-center justify-center relative z-0 border border-white/5 overflow-hidden">
                            <div class="absolute inset-0 bg-[url('https://source.unsplash.com/random/1200x800/?aquarium,fish')] bg-cover bg-center opacity-20 group-hover:opacity-30 transition-opacity duration-700"></div>
                            <div class="z-10 flex flex-col items-center backdrop-blur-sm p-4 rounded-xl bg-black/20">
                                <i class="fa-solid fa-video-slash text-4xl text-slate-500 mb-3 animate-pulse"></i>
                                <h3 class="text-slate-300 font-medium font-mono">NO SIGNAL</h3>
                                <p class="text-xs text-slate-500">Connecting to stream...</p>
                            </div>
                        </div>
                    </div>

                    <div class="row g-4">
                        <div class="col-md-4">
                            <div class="glass-panel p-4 h-100 flex flex-col items-center justify-center relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-20 h-20 bg-amber-500/20 blur-2xl rounded-full -mr-10 -mt-10"></div>
                                <div class="relative w-24 h-24 mb-3">
                                    <svg class="w-full h-full transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="rgba(255,255,255,0.05)" stroke-width="8" fill="transparent" />
                                        <circle id="circleTemp" cx="48" cy="48" r="40" stroke="#f59e0b" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="251.2" stroke-linecap="round" class="progress-ring__circle" />
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center flex-col">
                                        <i class="fa-solid fa-temperature-half text-amber-500 mb-1"></i>
                                        <span class="text-xs text-slate-400">Temp</span>
                                    </div>
                                </div>
                                <h3 class="text-3xl font-bold text-white font-mono"><span id="valTemp">--</span><span class="text-lg text-slate-500">°C</span></h3>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="glass-panel p-4 h-100 flex flex-col items-center justify-center relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-20 h-20 bg-cyan-500/20 blur-2xl rounded-full -mr-10 -mt-10"></div>
                                <div class="relative w-24 h-24 mb-3">
                                    <svg class="w-full h-full transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="rgba(255,255,255,0.05)" stroke-width="8" fill="transparent" />
                                        <circle id="circleTds" cx="48" cy="48" r="40" stroke="#06b6d4" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="251.2" stroke-linecap="round" class="progress-ring__circle" />
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center flex-col">
                                        <i class="fa-solid fa-droplet text-cyan-500 mb-1"></i>
                                        <span class="text-xs text-slate-400">TDS</span>
                                    </div>
                                </div>
                                <h3 class="text-3xl font-bold text-white font-mono"><span id="valTds">--</span><span class="text-lg text-slate-500">ppm</span></h3>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="glass-panel p-4 h-100 flex flex-col items-center justify-center relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-20 h-20 bg-emerald-500/20 blur-2xl rounded-full -mr-10 -mt-10"></div>
                                <div class="relative w-24 h-24 mb-3">
                                    <svg class="w-full h-full transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="rgba(255,255,255,0.05)" stroke-width="8" fill="transparent" />
                                        <circle id="circleLevel" cx="48" cy="48" r="40" stroke="#10b981" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="251.2" stroke-linecap="round" class="progress-ring__circle" />
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center flex-col">
                                        <i class="fa-solid fa-layer-group text-emerald-500 mb-1"></i>
                                        <span class="text-xs text-slate-400">Level</span>
                                    </div>
                                </div>
                                <h3 class="text-3xl font-bold text-white font-mono"><span id="valLevel">--</span><span class="text-lg text-slate-500">%</span></h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 animate__animated animate__fadeInRight animate__delay-1s">
                <div class="d-flex flex-column gap-4 h-100">
                    <div class="glass-panel p-6 border-t-4 border-t-primary relative">
                        <div class="flex items-start gap-4 mb-6">
                            <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-primary to-indigo-600 flex items-center justify-center text-white shadow-lg">
                                <i class="fa-solid fa-wand-magic-sparkles text-xl animate-pulse-slow"></i>
                            </div>
                            <div>
                                <h2 class="font-bold text-white text-lg font-sans">AI Brain</h2>
                                <p class="text-xs text-slate-400">Gemini 3.0 Flash Preview</p>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label class="text-[10px] font-bold text-slate-500 uppercase ml-1 mb-1 block">Tank Size</label>
                                <select id="tankSize" onchange="checkCustomTank(this)" class="modern-input w-full rounded-xl p-3 text-sm cursor-pointer appearance-none">
                                    <option value="24 inch">Standard 24"</option>
                                    <option value="36 inch">Long 36"</option>
                                    <option value="48 inch">Display 48"</option>
                                    <option value="Nano">Nano Cube</option>
                                    <option value="custom">Custom Size (ระบุเอง)</option>
                                </select>
                                <input type="text" id="customTankInput" class="modern-input w-full rounded-xl p-3 text-sm mt-2 hidden" placeholder="ระบุขนาด (เช่น 60x30x30 cm)">
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-slate-500 uppercase ml-1 mb-1 block">Livestock</label>
                                <input type="text" id="livestock" placeholder="e.g. Betta, 2 Snails" class="modern-input w-full rounded-xl p-3 text-sm">
                            </div>
                            <button onclick="runAI()" id="aiBtn" class="w-full bg-gradient-to-r from-primary to-indigo-600 hover:to-indigo-500 text-white font-semibold py-3.5 rounded-xl transition-all shadow-lg flex justify-center items-center gap-2 mt-2 group">
                                <span class="group-hover:tracking-wider transition-all">Optimize Environment</span>
                                <i class="fa-solid fa-bolt text-xs text-yellow-300"></i>
                            </button>
                        </div>

                        <div id="aiPanel" class="mt-6 hidden animate__animated animate__fadeInUp space-y-3">
                            <div class="bg-black/40 p-3 rounded-xl border border-white/5">
                                <h4 class="text-[10px] text-accent font-bold uppercase mb-2"><i class="fa-solid fa-microchip"></i> System Actions Applied:</h4>
                                <ul id="aiActionLog" class="text-xs text-slate-300 space-y-1 font-mono">
                                    </ul>
                            </div>

                            <div class="bg-slate-800/80 p-4 rounded-2xl rounded-tl-none border border-white/10 shadow-lg relative">
                                <div class="absolute -top-2 -left-0 w-3 h-3 bg-slate-800/80 clip-path-polygon"></div>
                                <div class="flex items-center gap-2 mb-2 pb-2 border-b border-white/5">
                                    <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                                    <span class="text-[10px] font-bold text-slate-400 uppercase">AI Recommendation</span>
                                </div>
                                <p id="aiMsg" class="text-sm text-slate-200 font-light leading-relaxed">...</p>
                            </div>
                        </div>
                    </div>

                    <div class="glass-panel p-6 flex-grow">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="font-bold text-white text-sm uppercase tracking-wider">Overrides</h3>
                            <i class="fa-solid fa-sliders text-slate-500"></i>
                        </div>
                        <div class="space-y-4">
                            <div class="group flex items-center justify-between p-3 rounded-2xl bg-white/5 hover:bg-white/10 transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400"><i class="fa-solid fa-water"></i></div>
                                    <div><p class="text-sm font-semibold text-white">Main Pump</p><p class="text-[10px] text-slate-400">Circulation</p></div>
                                </div>
                                <div class="relative inline-block w-11 h-6 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="togglePump" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 border-slate-700 appearance-none cursor-pointer transition-all duration-300 top-0.5 left-0.5"/>
                                    <label for="togglePump" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-700 cursor-pointer transition-colors duration-300"></label>
                                </div>
                            </div>
                            <div class="group flex items-center justify-between p-3 rounded-2xl bg-white/5 hover:bg-white/10 transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-amber-500/20 flex items-center justify-center text-amber-400"><i class="fa-regular fa-lightbulb"></i></div>
                                    <div><p class="text-sm font-semibold text-white">Grow Lights</p><p class="text-[10px] text-slate-400">Photosynthesis</p></div>
                                </div>
                                <div class="relative inline-block w-11 h-6 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="toggleLight" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 border-slate-700 appearance-none cursor-pointer transition-all duration-300 top-0.5 left-0.5"/>
                                    <label for="toggleLight" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-700 cursor-pointer transition-colors duration-300"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center"><p class="text-[10px] text-slate-600 font-mono uppercase tracking-widest" id="ghostLog">System Ready</p></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 1. CONFIGURATION
        const firebaseConfig = {
            apiKey: "AIzaSyBtLJPZfdkBy6SZtOUQo19SgbTL_-W_xaM",
            authDomain: "aqua-intelligence-ab8bd.firebaseapp.com",
            databaseURL: "https://aqua-intelligence-ab8bd-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "aqua-intelligence-ab8bd",
            storageBucket: "aqua-intelligence-ab8bd.firebasestorage.app",
            messagingSenderId: "611091827722",
            appId: "1:611091827722:web:eb829c1d79d8c76cf0e3f3"
        };

        const GEMINI_API_KEY = 'AIzaSyCArVERTU1rHnihJ8ad7z09ykfHc75LK7Y';

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();
            
            const connectedRef = db.ref(".info/connected");
            connectedRef.on("value", (snap) => {
                const elDot = document.getElementById('statusDot');
                const elText = document.getElementById('statusText');
                const elPing = document.getElementById('statusPing');
                if (snap.val() === true) {
                    elDot.className = "w-3 h-3 bg-emerald-500 rounded-full";
                    elPing.className = "absolute inset-0 bg-emerald-500 rounded-full animate-ping opacity-75";
                    elText.innerText = "ONLINE";
                    elText.className = "text-xs font-bold text-emerald-400 font-mono tracking-wider";
                } else {
                    elDot.className = "w-3 h-3 bg-rose-500 rounded-full";
                    elPing.className = "hidden";
                    elText.innerText = "OFFLINE";
                    elText.className = "text-xs font-bold text-rose-400 font-mono tracking-wider";
                }
            });

            startGhostBoard(db);
            listenToConfig(db);
        } catch (e) {
            console.error(e);
            alert("Firebase Error");
        }

        // 2. HELPER: Check for Custom Tank
        function checkCustomTank(select) {
            const customInput = document.getElementById('customTankInput');
            if (select.value === 'custom') {
                customInput.classList.remove('hidden');
                customInput.focus();
            } else {
                customInput.classList.add('hidden');
            }
        }

        // 3. GHOST BOARD
        function startGhostBoard(database) {
            setInterval(() => {
                const temp = (26 + Math.random() * 2).toFixed(1);
                const tds = Math.floor(100 + Math.random() * 50);
                const level = Math.floor(90 + Math.random() * 5);
                const sensorData = { temp: parseFloat(temp), tds: parseInt(tds), level: parseInt(level), timestamp: Date.now() };
                database.ref('sensors').set(sensorData);
                document.getElementById('ghostLog').innerText = `SYNC: T${temp} | TDS${tds} | L${level}`;
                updateSensorUI(sensorData);
            }, 3000);
        }

        function updateSensorUI(data) {
            document.getElementById('valTemp').innerText = data.temp;
            document.getElementById('valTds').innerText = data.tds;
            document.getElementById('valLevel').innerText = data.level;
            const circumference = 251.2;
            document.getElementById('circleTemp').style.strokeDashoffset = circumference - (Math.min((data.temp / 40), 1) * circumference);
            document.getElementById('circleTds').style.strokeDashoffset = circumference - (Math.min((data.tds / 500), 1) * circumference);
            document.getElementById('circleLevel').style.strokeDashoffset = circumference - (Math.min((data.level / 100), 1) * circumference);
        }

        // 4. GEMINI AI (V3.5 Enhanced)
        async function runAI() {
            let tank = document.getElementById('tankSize').value;
            // Handle Custom Tank
            if (tank === 'custom') {
                tank = document.getElementById('customTankInput').value || "Unknown Custom Size";
            }
            const live = document.getElementById('livestock').value;
            const btn = document.getElementById('aiBtn');
            const aiPanel = document.getElementById('aiPanel');
            const aiMsg = document.getElementById('aiMsg');
            const actionLog = document.getElementById('aiActionLog');

            const originalBtn = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> กำลังวิเคราะห์...';
            btn.classList.add('opacity-75', 'cursor-not-allowed');
            
            // Updated Prompt to ask for specific lighting advice
            const systemPrompt = "Role: IoT Expert. Output JSON only. Keys: p(0=off,1=on), t(target), msg(Thai advice short, MUST include recommended light hours per day).";
            const userPrompt = `Input: Tank=${tank}, Fish=${live}`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-3-flash-preview:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: systemPrompt + " " + userPrompt }] }] })
                });

                const data = await response.json();

                if (data.error) {
                    alert("Google API Error: " + data.error.message);
                    return;
                }

                if (!data.candidates) {
                    alert("AI returned no answer.");
                    return;
                }

                const rawText = data.candidates[0].content.parts[0].text.replace(/```json/g, '').replace(/```/g, '').trim();
                const json = JSON.parse(rawText);

                aiPanel.classList.remove('hidden');
                aiMsg.innerText = json.msg;

                // --- NEW: Generate Action Log for Transparency ---
                let actions = "";
                actions += `<li class="flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-blue-400"></div> Pump: ${json.p === 1 ? '<span class="text-green-400">OPEN</span>' : '<span class="text-red-400">CLOSED</span>'}</li>`;
                actions += `<li class="flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-amber-400"></div> Target Temp: <span class="text-white font-bold">${json.t}°C</span></li>`;
                // Try to extract hours from msg if possible, otherwise rely on text advice
                actions += `<li class="flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-purple-400"></div> Note: See lighting advice below</li>`;
                
                actionLog.innerHTML = actions;
                // ------------------------------------------------

                const db = firebase.database();
                db.ref('config').update({
                    pumpMode: json.p,
                    targetTemp: json.t
                });

            } catch (err) {
                console.error(err);
                alert("Critical Error: " + err.message);
            } finally {
                btn.innerHTML = originalBtn;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }

        // 5. MANUAL CONTROLS (Synced with Database)
        function listenToConfig(database) {
            database.ref('config').on('value', (snap) => {
                const config = snap.val() || {};
                
                // Update Checkboxes
                document.getElementById('togglePump').checked = (config.pumpMode === 1);
                document.getElementById('toggleLight').checked = (config.light === 1);
            });

            document.getElementById('togglePump').addEventListener('change', (e) => {
                database.ref('config/pumpMode').set(e.target.checked ? 1 : 0);
            });

            document.getElementById('toggleLight').addEventListener('change', (e) => {
                database.ref('config/light').set(e.target.checked ? 1 : 0);
            });
        }
    </script>
</body>
</html>